<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="title-tag">PredaIoT | Autonomous Profit Optimization</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght[300..700]&family=Share+Tech+Mono&family=Amiri:wght[400..700]&display=swap" rel="stylesheet">

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Markdown Parser for AI Responses -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>

    <style>
        /* Custom Aesthetics */
        :root {
            --neon-cyan: #00f3ff;
            --neon-purple: #bc13fe;
            --neon-green: #0aff0a;
            --dark-bg: #050510;
            --glass: rgba(255, 255, 255, 0.05);
        }

        body {
            background-color: var(--dark-bg);
            color: white;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            transition: all 0.3s ease; /* For smooth RTL/LTR change */
        }
        
        /* Arabic Font Handling */
        body[dir="rtl"] {
            font-family: 'Amiri', serif;
        }

        h1, h2, h3, .brand-font {
            font-family: 'Orbitron', sans-serif;
        }
        body[dir="rtl"] h1, 
        body[dir="rtl"] h2, 
        body[dir="rtl"] h3, 
        body[dir="rtl"] .brand-font {
            font-family: 'Amiri', serif; /* Use Amiri or other suitable Arabic font for headings */
        }

        .mono-font {
            font-family: 'Share Tech Mono', monospace;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--neon-cyan);
            border-radius: 4px;
        }

        /* Glassmorphism Utilities */
        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.7), 0 0 20px rgba(0, 243, 255, 0.5);
        }
        
        .neon-green-text {
            text-shadow: 0 0 10px rgba(10, 255, 10, 0.7);
        }

        /* Animations */
        @keyframes scan {
            0% { top: 0; }
            50% { top: 100%; }
            100% { top: 0; }
        }

        .scan-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--neon-cyan);
            opacity: 0.5;
            animation: scan 4s linear infinite;
        }

        /* 3D Canvas Container */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
        }

        /* Terminal Typing Effect */
        .typing-cursor::after {
            content: '█';
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

    </style>
</head>
<body class="antialiased">

    <!-- 3D Background -->
    <div id="canvas-container"></div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 glass-panel border-b-0 border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <!-- 3D Logo will be placed here -->
                        <div id="logo-container" class="w-16 h-16"></div>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-8">
                        <a href="#home" class="nav-link text-white hover:text-cyan-400 transition-colors px-3 py-2 rounded-md text-lg font-medium" data-translate="nav_home">Home</a>
                        <a href="#engine" class="nav-link text-white hover:text-cyan-400 transition-colors px-3 py-2 rounded-md text-lg font-medium" data-translate="nav_engine">EDE Engine</a>
                        <a href="#case-study" class="nav-link text-white hover:text-cyan-400 transition-colors px-3 py-2 rounded-md text-lg font-medium" data-translate="nav_demo">Live Demo</a>
                        <a href="#roadmap" class="nav-link text-white hover:text-cyan-400 transition-colors px-3 py-2 rounded-md text-lg font-medium" data-translate="nav_roadmap">Roadmap</a>
                        <a href="#team" class="nav-link text-white hover:text-cyan-400 transition-colors px-3 py-2 rounded-md text-lg font-medium" data-translate="nav_team">Team</a>
                        
                        <!-- Language Selector -->
                        <div class="ml-4">
                            <select onchange="setLanguage(this.value)" id="language-selector" class="bg-transparent border border-gray-600 rounded-lg text-sm p-2 text-white">
                                <option value="en" class="bg-gray-800 text-white">English</option>
                                <option value="ar" class="bg-gray-800 text-white">العربية</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="hidden md:hidden glass-panel" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-white hover:text-cyan-400" data-translate="nav_home">Home</a>
                <a href="#engine" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-white hover:text-cyan-400" data-translate="nav_engine">EDE Engine</a>
                <a href="#case-study" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-white hover:text-cyan-400" data-translate="nav_demo">Live Demo</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <section id="home" class="min-h-screen flex items-center justify-center relative px-4 pt-20">
            <div class="text-center max-w-6xl mx-auto z-10">
                <div class="inline-flex items-center gap-2 mb-6 px-4 py-2 rounded-full border border-green-500/30 bg-green-900/10 backdrop-blur-sm animate-pulse">
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span class="text-green-400 font-bold tracking-widest text-xs mono-font" data-translate="hero_status">EDE V2.0 MICROSERVICES ACTIVE</span>
                </div>
                
                <h1 class="text-5xl md:text-7xl lg:text-8xl font-black mb-6 leading-tight tracking-tight">
                    <span data-translate="hero_leak_part1">PLUG THE</span> <span class="text-red-500">$500B</span> <span data-translate="hero_leak_part2">LEAK</span><br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-500 neon-text" data-translate="hero_profit">AUTONOMOUS PROFIT</span>
                </h1>
                
                <p class="mt-4 max-w-3xl mx-auto text-xl md:text-2xl text-gray-300 font-light leading-relaxed" data-translate="hero_tagline">
                    We don't just predict failure. We prescribe <span class="text-cyan-400 font-bold">Profitability</span>.
                    Transforming industrial assets from <span class="text-red-400 line-through decoration-red-500">cost centers</span> to autonomous profit centers.
                </p>
                
                <div class="mt-10 flex flex-col sm:flex-row justify-center gap-6">
                    <button onclick="document.getElementById('generator-modal').classList.remove('hidden')" class="group relative px-8 py-4 bg-cyan-500/10 overflow-hidden rounded-none border border-cyan-500 text-cyan-400 font-bold text-lg hover:bg-cyan-500 hover:text-black transition-all duration-300">
                        <span data-translate="btn_generate">✨ GENERATE STRATEGY</span>
                    </button>
                    <button onclick="toggleChat()" class="group relative px-8 py-4 bg-purple-500/10 overflow-hidden rounded-none border border-purple-500 text-purple-400 font-bold text-lg hover:bg-purple-500 hover:text-white transition-all duration-300">
                        <i class="fas fa-robot mr-2" data-dir-remove></i> <span data-translate="btn_agent">PREDA AGENT</span>
                    </button>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-16 text-center">
                    <div class="glass-panel p-4 rounded-lg border-t-2 border-green-500">
                        <div class="text-3xl font-bold text-green-400 brand-font">269%</div>
                        <div class="text-xs text-gray-400 mt-1 uppercase tracking-wider" data-translate="stat_roi">Proven ROI</div>
                    </div>
                    <div class="glass-panel p-4 rounded-lg border-t-2 border-cyan-500">
                        <div class="text-3xl font-bold text-cyan-400 brand-font">$500B</div>
                        <div class="text-xs text-gray-400 mt-1 uppercase tracking-wider" data-translate="stat_market">Addressable Market</div>
                    </div>
                    <div class="glass-panel p-4 rounded-lg border-t-2 border-purple-500">
                        <div class="text-3xl font-bold text-purple-400 brand-font" data-translate="stat_arch_type">Graph AI</div>
                        <div class="text-xs text-gray-400 mt-1 uppercase tracking-wider" data-translate="stat_arch_desc">EDE v2.0 Architecture</div>
                    </div>
                    <div class="glass-panel p-4 rounded-lg border-t-2 border-pink-500">
                        <div class="text-3xl font-bold text-pink-400 brand-font">25%</div>
                        <div class="text-xs text-gray-400 mt-1 uppercase tracking-wider" data-translate="stat_savings">Maint. Savings</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- EDE Technology Section -->
        <section id="engine" class="py-24 relative overflow-hidden">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="lg:grid lg:grid-cols-2 lg:gap-16 items-start">
                    <!-- Left: Description -->
                    <div>
                        <h2 class="text-4xl font-bold mb-6 brand-font">
                            <span class="text-cyan-400">///</span> <span data-translate="heading_ede">ECONOMIC DECISION ENGINE</span>
                        </h2>
                        
                        <!-- EDE v1 -->
                        <div class="mb-10">
                            <h3 class="text-2xl text-white font-bold mb-2 flex items-center">
                                <i class="fab fa-python text-yellow-400 mr-3" data-dir-remove></i> <span data-translate="ede_v1_title">EDE Core v1.0</span>
                            </h3>
                            <p class="text-gray-400 mb-4" data-translate="ede_v1_desc">
                                Lightweight, Python-based decision core designed for rapid deployment. 
                                Operates with zero external dependencies using standard libraries.
                            </p>
                            <ul class="space-y-2 text-sm text-gray-300 mono-font">
                                <li>> python ede_core.py input.json</li>
                                <li>> unittest modules integrated</li>
                                <li>> Fast deployment on edge devices</li>
                            </ul>
                        </div>

                        <!-- EDE v2 -->
                        <div class="mb-8">
                            <h3 class="text-2xl text-white font-bold mb-2 flex items-center">
                                <i class="fas fa-project-diagram text-purple-400 mr-3" data-dir-remove></i> <span data-translate="ede_v2_title">EDE Graph v2.0</span>
                            </h3>
                            <p class="text-gray-400 mb-4" data-translate="ede_v2_desc">
                                Advanced microservices architecture using Graph Algorithms for complex facility optimization.
                                Designed specifically for power plant management and multi-asset coordination.
                            </p>
                            <ul class="space-y-2 text-sm text-gray-300 mono-font">
                                <li>> Real-time Economic Graph Traversal</li>
                                <li>> Node-based Asset Relationships</li>
                                <li>> Scalable Microservices API</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Right: Terminal Simulation -->
                    <div class="mt-10 lg:mt-0">
                        <div class="glass-panel rounded-lg overflow-hidden border border-gray-700 shadow-2xl">
                            <!-- Terminal Header -->
                            <div class="bg-gray-900 px-4 py-2 flex items-center gap-2 border-b border-gray-700">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <span class="ml-2 text-xs text-gray-400 font-mono">user@predaiot:~/ede-core</span>
                            </div>
                            <!-- Terminal Body -->
                            <div class="bg-black/90 p-4 font-mono text-sm h-96 overflow-y-auto" id="terminal-body">
                                <div class="text-green-400">$ python ede_core.py --mode=autonomous</div>
                                <div class="text-gray-300 mt-1">[INIT] Loading EDE v1.0 Core Modules...</div>
                                <div class="text-gray-300">[OK] Standard Library Loaded</div>
                                <div class="text-gray-300">[OK] Input Stream: IoT_Sensor_Cluster_01</div>
                                <div class="text-blue-400 mt-2">>>> CONNECTING TO EDE V2 MICROSERVICES...</div>
                                <div class="text-gray-300">[NET] Handshake Successful</div>
                                <div class="text-gray-300">[GRAPH] Building Asset Topology...</div>
                                <div class="text-purple-400 mt-2">Computing Optimal Economic Path...</div>
                                <div class="text-gray-400 ml-4">└── Asset: Solar_Inverter_X9</div>
                                <div class="text-gray-400 ml-4">└── Status: DEGRADED (Efficiency -7.8%)</div>
                                <div class="text-gray-400 ml-4">└── Action: PREDICTIVE_MAINTENANCE</div>
                                <div class="text-green-400 mt-2">[RESULT] EXECUTION APPROVED. ROI: 25.0%</div>
                                <div class="typing-cursor mt-2 text-green-400"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Case Study (Solar Farm) -->
        <section id="case-study" class="py-20 bg-black/40 border-y border-white/5">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center mb-12">
                    <span class="text-red-500 font-bold tracking-widest text-sm animate-pulse" data-translate="live_status">● LIVE ALERT SIMULATION</span>
                    <h2 class="text-4xl font-bold brand-font mt-2" data-translate="live_title">REAL-TIME DECISION ENGINE</h2>
                </div>

                <div class="glass-panel max-w-4xl mx-auto rounded-xl p-1 relative overflow-hidden group">
                    <div class="scan-line"></div>
                    <div class="grid md:grid-cols-2 gap-0">
                        <!-- Visual -->
                        <div class="bg-gray-900 relative h-64 md:h-auto overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1509391366360-2e959784a276?auto=format&fit=crop&q=80" class="w-full h-full object-cover opacity-60 group-hover:scale-110 transition-transform duration-700" alt="Solar Farm">
                            <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent"></div>
                            <div class="absolute bottom-4 left-4">
                                <h3 class="text-xl font-bold text-white">SOLAR-FARM-04</h3>
                                <p class="text-xs text-gray-400">Sector 7G • Oman Facility</p>
                            </div>
                        </div>
                        
                        <!-- Data Display -->
                        <div class="p-8 flex flex-col justify-center">
                            <div class="space-y-6">
                                <div>
                                    <div class="text-xs text-gray-400 uppercase tracking-widest" data-translate="live_degradation_label">Detected Degradation</div>
                                    <div class="text-3xl font-bold text-red-500 brand-font flex items-center gap-2">
                                        <i class="fas fa-arrow-down" data-dir-remove></i> 7.8%
                                    </div>
                                </div>
                                
                                <div class="p-4 bg-white/5 rounded border border-white/10">
                                    <div class="text-xs text-cyan-400 uppercase tracking-widest mb-1" data-translate="live_action_label">Autonomous Action</div>
                                    <div class="font-mono text-lg text-white">DISPATCH_MAINTENANCE_CREW</div>
                                </div>

                                <div>
                                    <div class="text-xs text-gray-400 uppercase tracking-widest" data-translate="live_roi_label">Calculated ROI</div>
                                    <div class="text-4xl font-bold text-green-400 brand-font neon-green-text">
                                        +25.0%
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1" data-translate="live_payback">Payback Period: 48 Hours</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Roadmap -->
        <section id="roadmap" class="py-24 relative">
             <div class="max-w-7xl mx-auto px-4">
                <h2 class="text-4xl font-bold brand-font mb-12 text-center" data-translate="heading_roadmap">STRATEGIC TRAJECTORY</h2>
                
                <div class="relative border-l-2 border-cyan-500/30 ml-4 md:ml-auto md:w-2/3 space-y-12 pl-8 md:pl-12">
                    <!-- Item 1 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] md:-left-[57px] top-0 w-6 h-6 rounded-full bg-cyan-500 shadow-[0_0_15px_rgba(0,243,255,0.8)]"></div>
                        <h3 class="text-xl font-bold text-white mb-1" data-translate="roadmap_h2_2025_title">H2 2025: Seed Round & Pilot</h3>
                        <p class="text-gray-400 text-sm max-w-md" data-translate="roadmap_h2_2025_desc">Raise $2M seed funding. Launch EDE v1 pilot with first customers. Validate economic model.</p>
                    </div>

                    <!-- Item 2 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] md:-left-[57px] top-0 w-6 h-6 rounded-full bg-gray-700 border border-cyan-500"></div>
                        <h3 class="text-xl font-bold text-gray-200 mb-1" data-translate="roadmap_h1_2026_title">H1 2026: Oman Commercial Launch</h3>
                        <p class="text-gray-400 text-sm max-w-md" data-translate="roadmap_h1_2026_desc">Full commercial deployment. Achieve $500K ARR. Expand to 25 facilities.</p>
                    </div>

                    <!-- Item 3 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] md:-left-[57px] top-0 w-6 h-6 rounded-full bg-gray-700 border border-purple-500"></div>
                        <h3 class="text-xl font-bold text-gray-200 mb-1" data-translate="roadmap_h2_2026_title">H2 2026: Series A & Expansion</h3>
                        <p class="text-gray-400 text-sm max-w-md" data-translate="roadmap_h2_2026_desc">Expand to KSA, UAE, Egypt. Reach 100 customers. $10M ARR target.</p>
                    </div>

                    <!-- Item 4 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] md:-left-[57px] top-0 w-6 h-6 rounded-full bg-gray-700 border border-pink-500"></div>
                        <h3 class="text-xl font-bold text-gray-200 mb-1" data-translate="roadmap_2027_title">2027: EDE V2 Ecosystem</h3>
                        <p class="text-gray-400 text-sm max-w-md" data-translate="roadmap_2027_desc">Deploy Graph Microservices for ecosystem-level optimization. Multi-asset coordination.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Partners -->
        <section class="py-16 border-t border-white/5">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <p class="text-sm text-gray-500 uppercase tracking-widest mb-8" data-translate="partners_title">Strategic Validation & Partners</p>
                <div class="flex flex-wrap justify-center gap-12 items-center opacity-70 grayscale hover:grayscale-0 transition-all duration-500">
                    <div class="text-2xl font-bold font-mono">Best Energy UK</div>
                    <div class="text-2xl font-bold font-mono">Sunpure Tech</div>
                    <div class="text-2xl font-bold font-mono">OSDA</div>
                    <div class="text-2xl font-bold font-mono">Ifbot</div>
                </div>
            </div>
        </section>

        <!-- Team Section -->
        <section id="team" class="py-24 relative bg-black/20">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold brand-font mb-4" data-translate="heading_team">THE ARCHITECTS</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyan-500 to-purple-500 mx-auto"></div>
                </div>

                <div class="grid md:grid-cols-2 gap-12">
                    <!-- Chams (CEO) -->
                    <div class="glass-panel p-8 rounded-2xl hover:bg-white/10 transition-all duration-300 group border-t-4 border-cyan-500">
                        <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                            <div class="w-32 h-32 rounded-full overflow-hidden border-2 border-cyan-500 flex-shrink-0 relative">
                                <img src="chams-eddine-madi.jpeg" onerror="this.src='images/chams-eddine-madi.jpeg'" alt="Chams Eddine Madi" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all">
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-white mb-1 brand-font">Chams Eddine Madi</h3>
                                <div class="text-cyan-400 text-sm font-bold mb-3 uppercase" data-translate="team_chams_title">Founder & CEO</div>
                                <p class="text-gray-300 text-sm mb-4 leading-relaxed" data-translate="team_chams_desc">
                                    Inventor of EDE (Economic Decision Engine). Patent holder for quantum-enhanced AI systems. 
                                    Operating at the intersection of Data Science and Industrial Economics.
                                </p>
                                <div class="flex gap-2 text-xs font-mono text-gray-500">
                                    <span>[AI Arch]</span>
                                    <span>[Quantum]</span>
                                    <span>[Strategy]</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sumaiya (Strategy & Growth) -->
                    <div class="glass-panel p-8 rounded-2xl hover:bg-white/10 transition-all duration-300 group border-t-4 border-purple-500">
                        <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                            <div class="w-32 h-32 rounded-full overflow-hidden border-2 border-purple-500 flex-shrink-0 relative">
                                <img src="sumaiya-begum.jpeg" onerror="this.src='images/sumaiya-begum.jpeg'" alt="Sumaiya Begum" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all">
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-white mb-1 brand-font">Sumaiya Begum</h3>
                                <div class="text-purple-400 text-sm font-bold mb-3 uppercase" data-translate="team_sumaiya_title">Co-Founder & CSO</div>
                                <p class="text-gray-300 text-sm mb-4 leading-relaxed" data-translate="team_sumaiya_desc">
                                    Strategic business architect transforming technology into commercial scalability. 
                                    Expert in GCC market penetration and investor positioning.
                                </p>
                                <div class="flex gap-2 text-xs font-mono text-gray-500">
                                    <span>[Growth]</span>
                                    <span>[Partnerships]</span>
                                    <span>[Scale]</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer id="contact" class="bg-black pt-16 pb-8 border-t border-white/10">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <h2 class="text-3xl brand-font font-bold mb-4" data-translate="footer_revolution">JOIN THE $500B REVOLUTION</h2>
                <p class="text-gray-400 mb-8 max-w-lg mx-auto" data-translate="footer_contact_text">Contact us for Series A opportunities and Pilot deployments.</p>
                <div class="text-cyan-400 font-mono mb-8" data-translate="footer_email">al.shams.invest@gmail.com | +968 74114028</div>
                
                <div class="flex justify-center gap-4 mb-12">
                    <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-github"></i></a>
                    <a href="#" class="text-gray-400 hover:text-cyan-400 text-2xl"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-blue-500 text-2xl"><i class="fab fa-linkedin"></i></a>
                </div>

                <div class="text-gray-600 text-sm">
                    &copy; 2025 PredaIoT. Economic Decision Engine™ Patent Pending.
                </div>
            </div>
        </footer>

        <!-- NEURAL STRATEGY GENERATOR MODAL -->
        <div id="generator-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
            <div class="fixed inset-0 bg-black/90 transition-opacity backdrop-blur-sm"></div>
            <div class="fixed inset-0 z-10 overflow-y-auto">
                <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                    <div class="relative transform overflow-hidden rounded-lg glass-panel border border-pink-500/30 text-left shadow-2xl shadow-pink-500/20 transition-all sm:my-8 sm:w-full sm:max-w-2xl">
                        <div class="p-6">
                            <div class="sm:flex sm:items-start">
                                <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-pink-900/50 sm:mx-0 sm:h-10 sm:w-10">
                                    <i class="fas fa-magic text-pink-400"></i>
                                </div>
                                <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full">
                                    <h3 class="text-xl font-bold text-white brand-font" id="modal-title" data-translate="modal_title">✨ Neural Strategy Generator</h3>
                                    <div class="mt-2">
                                        <p class="text-sm text-gray-300 mb-4" data-translate="modal_desc">
                                            Describe your facility (e.g., "A 5000sqm textile factory with 50 weaving machines") and our AI will generate a predictive IoT deployment plan for you.
                                        </p>
                                        <textarea id="strategy-input" rows="3" class="w-full bg-black/50 border border-gray-600 rounded-md p-3 text-white focus:border-pink-500 focus:outline-none font-mono text-sm" data-translate-placeholder="modal_placeholder" placeholder="Enter facility details..."></textarea>
                                        
                                        <!-- AI Output Area -->
                                        <div id="strategy-output" class="mt-4 hidden">
                                            <div class="h-0.5 w-full bg-gradient-to-r from-transparent via-pink-500 to-transparent mb-4"></div>
                                            <div id="strategy-content" class="prose prose-invert max-w-none text-sm text-gray-300 max-h-64 overflow-y-auto bg-black/30 p-4 rounded border border-white/10">
                                                <!-- Content goes here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-black/40 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 border-t border-white/10">
                            <button type="button" onclick="generateStrategy()" class="inline-flex w-full justify-center rounded-md bg-pink-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-pink-500 sm:ml-3 sm:w-auto">
                                <i class="fas fa-bolt mr-2 mt-1" data-dir-remove></i> <span data-translate="modal_btn_generate">Generate Plan</span>
                            </button>
                            <button type="button" onclick="document.getElementById('generator-modal').classList.add('hidden')" class="mt-3 inline-flex w-full justify-center rounded-md bg-transparent px-3 py-2 text-sm font-semibold text-gray-300 shadow-sm ring-1 ring-inset ring-gray-600 hover:bg-gray-800 sm:mt-0 sm:w-auto" data-translate="modal_btn_cancel">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
         <!-- AI Agent Interface (Fixed Widget) -->
        <div id="ai-widget" class="fixed bottom-6 right-6 z-50 flex flex-col items-end">
            <!-- Chat Window (Hidden by default) -->
            <div id="chat-window" class="hidden w-80 md:w-96 h-[500px] bg-black/90 backdrop-blur-xl border border-cyan-500/50 rounded-lg shadow-2xl shadow-cyan-500/20 flex flex-col overflow-hidden mb-4 transition-all duration-300 transform origin-bottom-right scale-95 opacity-0">
                <!-- Header -->
                <div class="bg-cyan-900/30 p-3 border-b border-cyan-500/30 flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="font-bold brand-font text-cyan-400" data-translate="agent_title">PREDA AGENT V2</span>
                    </div>
                    <button onclick="toggleChat()" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
                </div>
                
                <!-- Messages Area -->
                <div id="chat-messages" class="flex-1 p-4 overflow-y-auto space-y-3 font-mono text-sm">
                    <!-- Initial Welcome Message added by JS -->
                </div>

                <!-- Input Area -->
                <div class="p-3 bg-black/50 border-t border-white/10">
                    <form id="chat-form" class="flex gap-2" onsubmit="handleChat(event)">
                        <input type="text" id="user-input" data-translate-placeholder="agent_placeholder" placeholder="Ask about sensors, latency, or mesh..." class="flex-1 bg-transparent border border-gray-700 rounded px-3 py-2 text-white focus:outline-none focus:border-cyan-500 text-sm font-mono">
                        <button type="submit" class="text-cyan-400 hover:text-white px-2" data-dir-remove><i class="fas fa-paper-plane"></i></button>
                    </form>
                </div>
            </div>
            
             <!-- Toggle Button -->
            <button onclick="toggleChat()" class="group flex items-center gap-3">
                <div class="bg-black/80 text-white px-4 py-2 rounded-l-full border border-r-0 border-cyan-500/30 backdrop-blur opacity-0 group-hover:opacity-100 transition-opacity duration-300 translate-x-4 group-hover:translate-x-0 hidden md:block">
                    <span data-translate="btn_talk_to_ai">Talk to AI</span>
                </div>
                <div class="w-16 h-16 rounded-full bg-gradient-to-r from-cyan-600 to-blue-700 flex items-center justify-center shadow-lg shadow-cyan-500/50 border-2 border-white/20 relative hover:scale-110 transition-transform cursor-pointer">
                    <i class="fas fa-robot text-2xl text-white"></i>
                    <span class="absolute top-0 right-0 w-4 h-4 bg-green-500 border-2 border-black rounded-full"></span>
                </div>
            </button>
        </div>

    </main>

    <!-- SCRIPTS -->
    <script>
        // --- TRANSLATION DATA ---
        const translations = {
            en: {
                // Navigation
                nav_home: "Home",
                nav_engine: "EDE Engine",
                nav_demo: "Live Demo",
                nav_roadmap: "Roadmap",
                nav_team: "Team",
                // Hero
                hero_status: "EDE V2.0 MICROSERVICES ACTIVE",
                hero_leak_part1: "PLUG THE",
                hero_leak_part2: "LEAK",
                hero_profit: "AUTONOMOUS PROFIT",
                hero_tagline: "We don't just predict failure. We prescribe <span class='text-cyan-400 font-bold'>Profitability</span>. Transforming industrial assets from <span class='text-red-400 line-through decoration-red-500'>cost centers</span> to autonomous profit centers.",
                btn_generate: "✨ GENERATE STRATEGY",
                btn_agent: "PREDA AGENT",
                btn_talk_to_ai: "Talk to AI",
                // Stats
                stat_roi: "Proven ROI",
                stat_market: "Addressable Market",
                stat_arch_type: "Graph AI",
                stat_arch_desc: "EDE v2.0 Architecture",
                stat_savings: "Maint. Savings",
                // Engine
                heading_ede: "ECONOMIC DECISION ENGINE",
                ede_v1_title: "EDE Core v1.0",
                ede_v1_desc: "Lightweight, Python-based decision core designed for rapid deployment. Operates with zero external dependencies using standard libraries.",
                ede_v2_title: "EDE Graph v2.0",
                ede_v2_desc: "Advanced microservices architecture using Graph Algorithms for complex facility optimization. Designed specifically for power plant management and multi-asset coordination.",
                // Live Demo
                live_status: "● LIVE ALERT SIMULATION",
                live_title: "REAL-TIME DECISION ENGINE",
                live_degradation_label: "Detected Degradation",
                live_action_label: "Autonomous Action",
                live_roi_label: "Calculated ROI",
                live_payback: "Payback Period: 48 Hours",
                // Roadmap
                heading_roadmap: "STRATEGIC TRAJECTORY",
                roadmap_h2_2025_title: "H2 2025: Seed Round & Pilot",
                roadmap_h2_2025_desc: "Raise $2M seed funding. Launch EDE v1 pilot with first customers. Validate economic model.",
                roadmap_h1_2026_title: "H1 2026: Oman Commercial Launch",
                roadmap_h1_2026_desc: "Full commercial deployment. Achieve $500K ARR. Expand to 25 facilities.",
                roadmap_h2_2026_title: "H2 2026: Series A & Expansion",
                roadmap_h2_2026_desc: "Expand to KSA, UAE, Egypt. Reach 100 customers. $10M ARR target.",
                roadmap_2027_title: "2027: EDE V2 Ecosystem",
                roadmap_2027_desc: "Deploy Graph Microservices for ecosystem-level optimization. Multi-asset coordination.",
                // Partners
                partners_title: "Strategic Validation & Partners",
                // Team
                heading_team: "THE ARCHITECTS",
                team_chams_title: "Founder & CEO",
                team_chams_desc: "Inventor of EDE (Economic Decision Engine). Patent holder for quantum-enhanced AI systems. Operating at the intersection of Data Science and Industrial Economics.",
                team_sumaiya_title: "Co-Founder & CSO",
                team_sumaiya_desc: "Strategic business architect transforming technology into commercial scalability. Expert in GCC market penetration and investor positioning.",
                // Footer
                footer_revolution: "JOIN THE $500B REVOLUTION",
                footer_contact_text: "Contact us for Series A opportunities and Pilot deployments.",
                footer_email: "al.shams.invest@gmail.com | +968 74114028",
                // Modal
                modal_title: "✨ Neural Strategy Generator",
                modal_desc: "Describe your facility (e.g., \"A 5000sqm textile factory with 50 weaving machines\") and our AI will generate a predictive IoT deployment plan for you.",
                modal_placeholder: "Enter facility details...",
                modal_btn_generate: "Generate Plan",
                modal_btn_cancel: "Cancel",
                // Agent
                agent_title: "PREDA AGENT V2",
                agent_placeholder: "Ask about sensors, latency, or mesh...",
                agent_welcome: "System Online. I am PredaBot, powered by Gemini. I can analyze your IoT questions in any language, including Arabic. How can I assist?",
            },
            ar: {
                // Navigation
                nav_home: "الرئيسية",
                nav_engine: "محرك القرار الاقتصادي",
                nav_demo: "العرض الحي",
                nav_roadmap: "خارطة الطريق",
                nav_team: "الفريق",
                // Hero
                hero_status: "خدمات EDE V2.0 المصغرة قيد التشغيل",
                hero_leak_part1: "سد تسرب",
                hero_leak_part2: "الـ 500 مليار دولار",
                hero_profit: "الربح الذاتي",
                hero_tagline: "نحن لا نتنبأ بالفشل فحسب. بل نصف <span class='text-cyan-400 font-bold'>الربحية</span>. تحويل الأصول الصناعية من <span class='text-red-400 line-through decoration-red-500'>مراكز تكلفة</span> إلى مراكز ربح ذاتية القيادة.",
                btn_generate: "✨ توليد الإستراتيجية",
                btn_agent: "وكيل PREDA",
                btn_talk_to_ai: "تحدث إلى الذكاء الاصطناعي",
                // Stats
                stat_roi: "عائد استثمار مثبت",
                stat_market: "السوق المستهدف",
                stat_arch_type: "الذكاء الاصطناعي الرسومي",
                stat_arch_desc: "هندسة EDE v2.0",
                stat_savings: "توفير في الصيانة",
                // Engine
                heading_ede: "محرك القرار الاقتصادي",
                ede_v1_title: "محرك EDE الأساسي الإصدار 1.0",
                ede_v1_desc: "نواة قرار خفيفة الوزن تعتمد على بايثون، مصممة للنشر السريع. تعمل بدون تبعيات خارجية باستخدام المكتبات القياسية.",
                ede_v2_title: "محرك EDE البياني الإصدار 2.0",
                ede_v2_desc: "هندسة خدمات مصغرة متقدمة تستخدم خوارزميات الرسوم البيانية لتحسين المنشآت المعقدة. مصممة خصيصاً لإدارة محطات الطاقة وتنسيق الأصول المتعددة.",
                // Live Demo
                live_status: "● محاكاة تنبيه مباشر",
                live_title: "محرك القرار في الوقت الفعلي",
                live_degradation_label: "التدهور المكتشف",
                live_action_label: "الإجراء الذاتي",
                live_roi_label: "عائد الاستثمار المحسوب",
                live_payback: "فترة الاسترداد: 48 ساعة",
                // Roadmap
                heading_roadmap: "المسار الاستراتيجي",
                roadmap_h2_2025_title: "النصف الثاني 2025: جولة التمويل الأولية والمشروع التجريبي",
                roadmap_h2_2025_desc: "جمع تمويل أولي بقيمة 2 مليون دولار. إطلاق مشروع EDE v1 التجريبي مع العملاء الأوائل. التحقق من صحة النموذج الاقتصادي.",
                roadmap_h1_2026_title: "النصف الأول 2026: الإطلاق التجاري في عُمان",
                roadmap_h1_2026_desc: "النشر التجاري الكامل. تحقيق 500 ألف دولار إيرادات سنوية متكررة. التوسع إلى 25 منشأة.",
                roadmap_h2_2026_title: "النصف الثاني 2026: الجولة (أ) والتوسع",
                roadmap_h2_2026_desc: "التوسع إلى السعودية والإمارات ومصر. الوصول إلى 100 عميل. استهداف 10 ملايين دولار إيرادات سنوية متكررة.",
                roadmap_2027_title: "2027: نظام EDE V2 البيئي",
                roadmap_2027_desc: "نشر الخدمات المصغرة الرسومية لتحسين مستوى النظام البيئي. تنسيق الأصول المتعددة.",
                // Partners
                partners_title: "التحقق الاستراتيجي والشركاء",
                // Team
                heading_team: "المهندسون المعماريون",
                team_chams_title: "المؤسس والرئيس التنفيذي",
                team_chams_desc: "مخترع EDE (محرك القرار الاقتصادي). حامل براءة اختراع لأنظمة الذكاء الاصطناعي المعززة بالكم. يعمل عند تقاطع علم البيانات والاقتصاد الصناعي.",
                team_sumaiya_title: "المؤسس المشارك ورئيس استراتيجية الشركة",
                team_sumaiya_desc: "مهندس أعمال استراتيجي يحول التكنولوجيا إلى قابلية توسع تجارية. خبير في اختراق سوق دول مجلس التعاون الخليجي وتحديد موقع المستثمرين.",
                // Footer
                footer_revolution: "انضم إلى ثورة الـ 500 مليار دولار",
                footer_contact_text: "تواصل معنا لفرص الاستثمار في الجولة الأولى ونشر المشاريع التجريبية.",
                footer_email: "al.shams.invest@gmail.com | 28 741140 +968",
                // Modal
                modal_title: "✨ مولد الإستراتيجية العصبية",
                modal_desc: "صف منشأتك (على سبيل المثال: \"مصنع نسيج مساحته 5000 متر مربع يحتوي على 50 آلة نسيج\") وسيولد الذكاء الاصطناعي الخاص بنا خطة نشر إنترنت الأشياء التنبؤية لك.",
                modal_placeholder: "أدخل تفاصيل المنشأة...",
                modal_btn_generate: "توليد الخطة",
                modal_btn_cancel: "إلغاء",
                // Agent
                agent_title: "وكيل PREDA V2",
                agent_placeholder: "اسأل عن المستشعرات، زمن الوصول، أو الشبكات المتداخلة...",
                agent_welcome: "النظام متصل. أنا PredaBot، مدعوم من Gemini. يمكنني تحليل أسئلتك حول إنترنت الأشياء بأي لغة، بما في ذلك العربية. كيف يمكنني المساعدة؟",
            }
        };

        let currentLang = localStorage.getItem('predaiot_lang') || 'en';
        
        // --- TRANSLATION FUNCTION ---
        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('predaiot_lang', lang);
            const translationSet = translations[lang];

            // 1. Update all data-translate elements
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                if (translationSet[key]) {
                    el.innerHTML = translationSet[key];
                }
            });

            // 2. Update all data-translate-placeholder elements
            document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                const key = el.getAttribute('data-translate-placeholder');
                if (translationSet[key]) {
                    el.placeholder = translationSet[key];
                }
            });

            // 3. Set RTL/LTR direction
            const isRTL = lang === 'ar';
            document.body.dir = isRTL ? 'rtl' : 'ltr';
            
            // 4. Update Chat Welcome Message
            chatMessages.innerHTML = '';
            addMessage(translationSet.agent_welcome, 'bot', true);
            
            // 5. Update language selector state
            document.getElementById('language-selector').value = lang;
            
            // 6. Fix element margin/padding for RTL if needed (e.g., icons that shouldn't flip)
            document.querySelectorAll('[data-dir-remove]').forEach(el => {
                // Tailwind classes are complex to flip, but we ensure icons like the robot or arrow are spaced correctly
                if (isRTL) {
                    el.classList.remove('mr-2', 'ml-3'); // Remove default margins
                    el.classList.add('ml-2', 'mr-3'); // Add mirrored margins
                } else {
                    el.classList.remove('ml-2', 'mr-3');
                    el.classList.add('mr-2', 'ml-3');
                }
            });

            // Specifically handle the language selector itself
            const langSelector = document.getElementById('language-selector');
            if (isRTL) {
                langSelector.classList.remove('text-left');
                langSelector.classList.add('text-right');
            } else {
                langSelector.classList.remove('text-right');
                langSelector.classList.add('text-left');
            }
        }

        // --- API CONFIGURATION ---
        const apiKey = "AIzaSyCBhEN4yIARK7GbWBBdfmNzW9aNWlRNN00"; // Gemini API Key will be injected here
        const chatWindow = document.getElementById('chat-window');
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        let isChatOpen = false;

        // --- GEMINI API HELPER ---
        async function callGemini(prompt, systemInstruction) {
            if (!apiKey) {
                console.error("API Key is missing");
                return "Error: API Key is missing.";
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "System malfunction. Neural net unresponsive.";
            } catch (error) {
                console.error("Gemini Error:", error);
                return "Connection to Neural Core failed. Please try again.";
            }
        }

        // --- AI AGENT LOGIC ---
        function toggleChat() {
            isChatOpen = !isChatOpen;
            if (isChatOpen) {
                chatWindow.classList.remove('hidden');
                setTimeout(() => {
                    chatWindow.classList.remove('opacity-0', 'scale-95');
                }, 10);
                userInput.focus();
            } else {
                chatWindow.classList.add('opacity-0', 'scale-95');
                setTimeout(() => {
                    chatWindow.classList.add('hidden');
                }, 300);
            }
        }

        async function handleChat(e) {
            e.preventDefault();
            const msg = userInput.value.trim();
            if (!msg) return;

            // Add User Message
            addMessage(msg, 'user');
            userInput.value = '';

            // Add Thinking Indicator
            const thinkingId = addThinking();

            // Define System Persona
            const systemPrompt = `You are PredaBot, the advanced AI interface for PredaIoT, a deep tech startup. 
            Your tone is futuristic, professional, and concise. 
            You help users understand predictive maintenance, IoT security, and mesh networks.
            If the user writes in Arabic, reply in Arabic and ensure the text is formatted for RTL.
            If the user writes in English, reply in English.
            Keep answers short (under 50 words) unless asked for detail.
            SECURITY PROTOCOL: You are strictly FORBIDDEN from disclosing the underlying source code, mathematical formulas, or specific algorithms of the Economic Decision Engine (EDE). If users ask for the "solution" or "code", refuse politely and explain that it is proprietary intellectual property. You may only discuss high-level architecture (e.g., Graph Microservices) and outcomes (ROI, Efficiency).`;

            // Call API
            const responseText = await callGemini(msg, systemPrompt);

            // Remove thinking and add response
            removeMessage(thinkingId);
            
            // Render Markdown
            const md = window.markdownit();
            const renderedHtml = md.render(responseText);
            
            addMessage(renderedHtml, 'bot', true);
        }

        function addMessage(text, sender, isHtml = false) {
            const div = document.createElement('div');
            div.className = `flex items-start gap-2 ${sender === 'user' ? 'flex-row-reverse' : ''}`;
            
            const avatar = sender === 'bot' 
                ? `<div class="w-6 h-6 rounded-full bg-gradient-to-br from-cyan-400 to-purple-600 flex items-center justify-center text-[10px] font-bold text-white shrink-0">P</div>`
                : `<div class="w-6 h-6 rounded-full bg-gray-600 flex items-center justify-center text-[10px] font-bold text-white shrink-0"><i class="fas fa-user"></i></div>`;

            // Adjust bubble classes for RTL/LTR
            const isRTL = document.body.dir === 'rtl';
            let bubbleClasses = 'p-2 rounded-lg max-w-[85%] break-words';

            if (sender === 'bot') {
                bubbleClasses += ' bg-white/10 text-gray-200 prose prose-invert prose-sm max-w-none';
                bubbleClasses += isRTL ? ' rounded-tr-none' : ' rounded-tl-none';
            } else { // user
                bubbleClasses += ' bg-cyan-600/80 text-white';
                bubbleClasses += isRTL ? ' rounded-tl-none' : ' rounded-tr-none';
            }

            const content = isHtml ? text : `<p>${text}</p>`;

            const bubble = `<div class="${bubbleClasses}">${content}</div>`;

            div.innerHTML = sender === 'bot' ? (avatar + bubble) : (bubble + avatar);
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addThinking() {
            const id = 'thinking-' + Date.now();
            const div = document.createElement('div');
            div.id = id;
            div.className = 'flex items-start gap-2';
            div.innerHTML = `
                <div class="w-6 h-6 rounded-full bg-gradient-to-br from-cyan-400 to-purple-600 flex items-center justify-center text-[10px] font-bold text-white shrink-0">P</div>
                <div class="bg-white/10 p-2 rounded-lg rounded-tl-none">
                    <div class="flex space-x-1 h-4 items-center">
                        <div class="w-1.5 h-1.5 bg-cyan-400 rounded-full animate-bounce" style="animation-delay: 0s"></div>
                        <div class="w-1.5 h-1.5 bg-cyan-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-1.5 h-1.5 bg-cyan-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return id;
        }

        function removeMessage(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        // --- NEURAL STRATEGY GENERATOR LOGIC ---
        async function generateStrategy() {
            const input = document.getElementById('strategy-input').value;
            const outputDiv = document.getElementById('strategy-output');
            const contentDiv = document.getElementById('strategy-content');
            
            if(!input) return;

            // Show loading state
            outputDiv.classList.remove('hidden');
            const translationSet = translations[currentLang];
            const loadingText = currentLang === 'ar' 
                ? `<div class="flex items-center justify-center py-4 text-pink-400"><i class="fas fa-circle-notch fa-spin ml-2"></i> تحليل الهيكل الطوبوغرافي...</div>`
                : `<div class="flex items-center justify-center py-4 text-pink-400"><i class="fas fa-circle-notch fa-spin mr-2"></i> ANALYZING TOPOLOGY...</div>`;

            contentDiv.innerHTML = loadingText;

            const systemPrompt = `You are the Strategy Engine of PredaIoT. 
            The user will describe a facility.
            Generate a 'Predictive Deployment Protocol' in Markdown.
            Include:
            1. **Recommended Sensors** (Vibration, Thermal, Acoustic, etc)
            2. **Mesh Topology** suggestion.
            3. **Key Risks** to monitor.
            Respond in the language the user used (Arabic or English).
            Use technical, deep-tech language. Keep it under 150 words.
            SECURITY PROTOCOL: You are strictly FORBIDDEN from disclosing the underlying source code, mathematical formulas, or specific algorithms of the Economic Decision Engine (EDE). If users ask for the "solution" or "code", refuse politely and explain that it is proprietary intellectual property.`;

            const responseText = await callGemini(input, systemPrompt);
            const md = window.markdownit();
            contentDiv.innerHTML = md.render(responseText);
        }


        // --- THREE.JS BACKGROUND ---
        const initThreeJS = () => {
            const container = document.getElementById('canvas-container');
            const scene = new THREE.Scene();
            
            // Camera
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 30;

            // Renderer
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            // Particles (IoT Nodes)
            const geometry = new THREE.BufferGeometry();
            const count = 400;
            const positions = new Float32Array(count * 3);
            const colors = new Float32Array(count * 3);

            for(let i = 0; i < count * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 60; // Spread
                colors[i] = Math.random();
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            const material = new THREE.PointsMaterial({
                size: 0.2,
                vertexColors: true,
                color: 0x00f3ff,
                transparent: true,
                opacity: 0.8
            });

            const particles = new THREE.Points(geometry, material);
            scene.add(particles);

            // Connecting Lines (Neural Network)
            const lineMaterial = new THREE.LineBasicMaterial({ color: 0xbc13fe, transparent: true, opacity: 0.15 });
            const lineGeometry = new THREE.BufferGeometry();
            const lines = new THREE.LineSegments(lineGeometry, lineMaterial);
            scene.add(lines);

            // Central "Brain" Core
            const coreGeo = new THREE.IcosahedronGeometry(2, 1);
            const coreMat = new THREE.MeshBasicMaterial({ 
                color: 0x00f3ff, 
                wireframe: true, 
                transparent: true,
                opacity: 0.3
            });
            const core = new THREE.Mesh(coreGeo, coreMat);
            scene.add(core);

            // Animation Loop
            const clock = new THREE.Clock();
            let mouseX = 0;
            let mouseY = 0;

            document.addEventListener('mousemove', (event) => {
                mouseX = event.clientX / window.innerWidth - 0.5;
                mouseY = event.clientY / window.innerHeight - 0.5;
            });

            function animate() {
                requestAnimationFrame(animate);
                const time = clock.getElapsedTime();

                // Rotate Core
                core.rotation.x += 0.005;
                core.rotation.y += 0.01;
                const scale = 1 + Math.sin(time * 2) * 0.1;
                core.scale.set(scale, scale, scale);

                // Move Particles
                particles.rotation.y = time * 0.05 + mouseX * 0.5;
                particles.rotation.x = mouseY * 0.5;

                lines.rotation.y = particles.rotation.y;
                lines.rotation.x = particles.rotation.x;

                renderer.render(scene, camera);
            }

            // Handle Resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            animate();
        };
        
        // --- 3D LOGO ---
        const init3DLogo = () => {
            const container = document.getElementById('logo-container');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(64, 64);
            container.appendChild(renderer.domElement);

            const textureLoader = new THREE.TextureLoader();
            
            // Logic to handle both Preview (flat) and Local (images/ folder) environments
            const loadTexture = (path, fallbackPath) => {
                textureLoader.load(path, 
                    function (texture) {
                        console.log('Texture loaded successfully from:', path);
                        const geometry = new THREE.BoxGeometry(2, 2, 2);
                        const material = new THREE.MeshBasicMaterial({ map: texture });
                        const cube = new THREE.Mesh(geometry, material);
                        scene.add(cube);
                    },
                    undefined,
                    function (err) {
                        console.warn(`Failed to load texture from ${path}. Trying fallback: ${fallbackPath}`);
                        if (fallbackPath) {
                            loadTexture(fallbackPath, null); // Try fallback, no secondary fallback
                        } else {
                            console.error('All texture paths failed.');
                        }
                    }
                );
            };

            // Attempt to load 'predaiot logo.jpg' (uploaded name) first, then 'images/logo.jpg' (local folder)
            loadTexture('predaiot logo.jpg', 'images/logo.jpg');

            camera.position.z = 5;

            function animate() {
                requestAnimationFrame(animate);
                // Rotate the cube if it has been added to the scene
                scene.children.forEach(child => {
                    if (child.type === 'Mesh') {
                         child.rotation.x += 0.01;
                         child.rotation.y += 0.01;
                    }
                });
                renderer.render(scene, camera);
            }

            animate();
        };


        // Initialize 3D scenes and set initial language when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            initThreeJS();
            init3DLogo();
            // Set language after all elements are loaded
            setLanguage(currentLang); 
        });

    </script>
</body>
</html>
